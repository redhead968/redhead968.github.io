<!DOCTYPE html>
<html>

<head>
    <link rel="icon" type="image/jpeg"
        href="https://www.kyair.org.il/moaza/Departments/hinuch/PublishingImages/%D7%A1%D7%9E%D7%9C%20%D7%90%D7%99%D7%9C%D7%9F%20%D7%A8%D7%9E%D7%95%D7%9F.jpg">
    <style>
        table {
            width: 80%;
            border-collapse: collapse;
        }

        th,
        td {
            border: 1px solid black;
            padding: 8px;
            text-align: left;
            width: 20%;
        }

        th {
            background-color: lightgray;
        }

        div {
            border: 1px solid black;
            padding: 10px;
            width: 150px;
        }
    </style>
    <title>אתר שעות התנדבות - חיפוש</title>
</head>

<body style="background-color:rgb(240, 240, 240);" dir="rtl">
    <center>
        <h1 id="volunteering times">שעות התנדבות</h1>
        <!DOCTYPE html>
        <html>



        <table id="times">
            <tr>
                <th>מקום התנדבות</th>
                <th>תאריך</th>
                <th>שעת התחלה</th>
                <th>שעת סיום</th>
                <th>סך הכול שעות במפגש הזה</th>
            </tr>
        </table>


    </center>
    <script src="data.js"></script>
    <script>
        var hash = location.hash;
        hash = decodeURIComponent(hash);

        hash = hash.replace("#", "").trim();

        hash = hash.split(" ").filter(x => x != ("")).join(" ")

        var lines = data.split("\n").filter(line => line.length > 0);

        console.log("hash = " + hash);

        const title = document.getElementById("volunteering times")

        title.innerHTML += "/" + hash

        for (var i = 0; i < lines.length; i++) {

            lines[i] = lines[i].split(",");
        }


        function convertToObj(a, b) {
            if (a.length != b.length || a.length == 0 || b.length == 0) {
                return null;
            }
            let obj = {};

            // Using the foreach method
            a.forEach((k, i) => { obj[k] = b[i] })
            return obj;
        }


        var objects = [];
        var whitelist = [];

        for (var i = 1; i < lines.length; i++) {
            objects.push(convertToObj(lines[0], lines[i]))


        }
        var space = " ";

        for (var i = 0; i < objects.length; i++) {
            // -=+=- if object = # according to checkNames -=+=- \\
            var object = objects[i];
            var family = object["שם משפחה של התלמיד/ה"];
            var name = object["שם פרטי של התלמיד/ה"];
            if (checkNames(hash, name, family)) {
                whitelist.push(object)
            }
        }
        console.log(whitelist)
        var table = document.getElementById("times")
        for (var i = 0; i < whitelist.length; i++) {
            var newRow = document.createElement("tr");

            // Create three new cell elements and add text to each cell
            var cell1 = document.createElement("td");
            cell1.textContent = whitelist[i]["מקום התנדבות"];
            var cell2 = document.createElement("td");
            cell2.textContent = whitelist[i]["תאריך"];
            var cell3 = document.createElement("td");
            cell3.textContent = whitelist[i]["שעת התחלה  "];
            var cell4 = document.createElement("td");
            cell4.textContent = whitelist[i]["שעת סיום "];
            var cell5 = document.createElement("td");
            cell5.textContent = "Cell 5";

            // Append the three cells to the new row element
            newRow.appendChild(cell1);
            newRow.appendChild(cell2);
            newRow.appendChild(cell3);
            newRow.appendChild(cell4);
            newRow.appendChild(cell5);


            // Append the new row to the table
            table.appendChild(newRow);



        }


        function checkNames(full, name, family) {
            if (name + space + family == full) {
                return true;
            } else {
                return false;
            }
            // -=+=- check if full = name + famliy -=+=- 
        }
    </script>
</body>

</html>
<!-- לסדר את הסך הכול שעות בטבלה -->